---
title: Использование сторонних центров сертификации (ЦС) со службой регистрации сертификатов для сетевых устройств (SCEP) в Microsoft Intune — Azure | Документация Майкрософт
description: В Microsoft Intune можно добавить центр сертификации (ЦС) поставщика или сторонний ЦС для выдачи сертификатов для мобильных устройств, использующих протокол SCEP. В этом обзоре приложение Azure Active Directory (Azure AD) предоставляет Microsoft Intune разрешения для проверки сертификатов. Затем идентификатор приложения, ключ проверки подлинности и идентификатор клиента приложения AAD используются при настройке сервера SCEP для выдачи сертификатов.
keywords: ''
author: brenduns
ms.author: brenduns
manager: dougeby
ms.date: 07/03/2019
ms.topic: conceptual
ms.service: microsoft-intune
ms.subservice: protect
ms.localizationpriority: high
ms.technology: ''
ms.reviewer: ''
ms.suite: ems
search.appverid: MET150
ms.custom: intune-azure
ms.collection: M365-identity-device-management
ms.openlocfilehash: 1dfac34615c208328cab06a3fd047d3a9b99c794
ms.sourcegitcommit: 7f17d6eb9dd41b031a6af4148863d2ffc4f49551
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/21/2020
ms.locfileid: "79353896"
---
# <a name="add-partner-certification-authority-in-intune-using-scep"></a>Добавление центра сертификации партнера в Intune с помощью SCEP

Используйте в Intune сторонние центры сертификации (ЦС). Сторонние ЦС могут подготавливать мобильные устройства с новыми или продленными сертификатами, используя службу регистрации сертификатов для сетевых устройств (SCEP), и обеспечивать поддержку устройств Windows, iOS/iPadOS, Android и macOS.

Использование этой функции включает две части: API с открытым исходным кодом и задачи администратора Intune.

**Часть 1. Использование API с открытым исходным кодом**  
Корпорация Майкрософт разработала API для интеграции с Intune. С его помощью можно проверять сертификаты, отправлять уведомления об успешном или неудачном выполнении операции и использовать протокол SSL (в частности фабрику сокетов SSL) для обмена данными с Intune.

Этот API можно скачать в [общедоступном репозитории GitHub для API SCEP Intune](https://github.com/Microsoft/Intune-Resource-Access/tree/develop/src/CsrValidation) и использовать в своих решениях. Этот API можно использовать со сторонними серверами SCEP, чтобы выполнять собственную проверку запроса защиты в Intune перед тем, как SCEP предоставит устройству сертификат.

В статье, посвященной [интеграции с решением по управлению SCEP в Intune](scep-libraries-apis.md), содержатся дополнительные сведения об использовании API, его методах и тестировании созданного решения.

**Часть 2. Создание приложения и профиля**  
С помощью приложения Azure Active Directory (Azure AD) можно делегировать Intune права на обработку запросов SCEP, поступающих с устройств. Приложение Azure AD включает идентификатор приложения и значения ключа проверки подлинности, которые используются в решении API, создаваемом разработчиком. Затем с помощью Intune администраторы создают и развертывают профили сертификатов SCEP и могут просматривать отчеты о состоянии развертывания на устройствах.

В этой статье приводится обзор этой функции с точки зрения администратора, включая создание приложения Azure AD.

## <a name="overview"></a>Overview

Ниже приведены общие сведения об использовании SCEP для сертификатов в Intune.

1. В Intune администратор создает профиль сертификата SCEP, а затем назначает этот профиль пользователям или устройствам.
2. Устройство регистрируется в Intune.
3. Intune создает уникальный запрос защиты SCEP. Кроме того, платформа добавляет сведения дополнительной проверки целостности, например об ожидаемом субъекте и SAN.
4. Intune шифрует и подписывает как запрос, так и сведения проверки целостности, а затем отправляет эти сведения на устройство с помощью запроса SCEP.
5. Устройство создает запрос подписи сертификата и пару открытого и закрытого ключей на устройстве в зависимости от профиля сертификата SCEP, который был отправлен из Intune.
6. Запрос подписи и зашифрованный или подписанный запрос защиты отправляются в стороннюю конечную точку сервера SCEP.
7. Сервер SCEP отправляет запрос подписи и запрос защиты в Intune. Затем Intune проверяет подпись, расшифровывает полезные данные и сравнивает запрос подписи со сведениями проверки целостности.
8. Intune отправляет ответ обратно на сервер SCEP и указывает, успешно ли выполнена проверка запроса защиты.  
9. Если запрос успешно проверен, сервер SCEP выдает сертификат для устройства.

На схеме ниже показан подробный поток интеграции сторонних SCEP с Intune:

> [!div class="mx-imgBorder"]
> ![Интеграция SCEP стороннего центра сертификации с Microsoft Intune](./media/certificate-authority-add-scep-overview/scep-certificate-vendor-integration.png)

## <a name="set-up-third-party-ca-integration"></a>Настройка интеграции сторонних ЦС

### <a name="validate-third-party-certification-authority"></a>Проверка сторонних центров сертификации

Перед интеграцией сторонних центров сертификации с Intune убедитесь, что используемый ЦС поддерживает Intune. В разделе [Сторонние центры сертификации партнеров](#third-party-certification-authority-partners) (этой статьи) содержится соответствующий список. Дополнительные сведения также можно найти в руководстве по центру сертификации. ЦС может включать специальные инструкции по установке в зависимости от реализации.

### <a name="authorize-communication-between-ca-and-intune"></a>Авторизация обмена данными между ЦС и Intune

Чтобы разрешить стороннему серверу SCEP выполнять пользовательскую проверку запроса защиты в Intune, создайте приложение в Azure AD. Это приложение делегирует Intune права для проверки запросов SCEP.

Убедитесь, что у вас есть необходимые разрешения для регистрации приложения Azure AD. Ознакомьтесь с разделом о [необходимых разрешениях](https://docs.microsoft.com/azure/azure-resource-manager/resource-group-create-service-principal-portal#required-permissions) в документации по Azure AD.

#### <a name="create-an-application-in-azure-active-directory"></a>Создание приложения в Azure Active Directory.  

1. На [портале Azure](https://portal.azure.com) выберите **Azure Active Directory** > **Регистрация приложений**, а затем — **Новая регистрация**.  

2. На странице **Регистрация приложения** укажите следующие сведения:  
   - В разделе **Имя** введите понятное имя для приложения.  
   - В разделе **Поддерживаемые типы учетных записей** выберите **Учетные записи в любом каталоге организации**.  
   - Для параметра **URI перенаправления** оставьте значение по умолчанию "Интернет", а затем укажите URL-адрес входа для стороннего сервера SCEP.  

3. Выберите **Зарегистрировать**, чтобы создать приложение и открыть страницу "Обзор" для нового приложения.  

4. В приложении на странице **Обзор** скопируйте значение **идентификатора приложения (клиента)** и запишите его для последующего использования. Это значение понадобится позже.  

5. В области навигации для приложения перейдите в раздел **Certificates & secrets** (Сертификаты и секреты) в разделе **Управление**. Нажмите кнопку **New client secret** (Новый секрет клиента). Введите значение в поле "Описание", выберите любой параметр в области **Срок действия истекает** и щелкните **Добавить**, чтобы создать *значение* для секрета клиента. 
   > [!IMPORTANT]  
   > Перед тем как покинуть эту страницу, скопируйте значение для секрета клиента и запишите его для последующего использования в реализации стороннего ЦС. Это значение больше не отображается. Обязательно изучите руководство стороннего ЦС, чтобы получить представление о правильной настройке идентификатора приложения, ключа проверки подлинности и идентификатора клиента.  

6. Запишите **идентификатор клиента**. Идентификатор клиента — это текст имени домена после символа @ в вашей учетной записи. Например, если ваша учетная запись — *admin@name.onmicrosoft.com* , то идентификатор клиента — **name.onmicrosoft.com**.  

7. В области навигации для приложения перейдите в раздел **Разрешения API** в области **Управление**, а затем выберите **Добавить разрешение**.  

8. На странице **Запрос разрешений API** выберите **Intune**, а затем — **Разрешения приложений**. Установите флажок **scep_challenge_provider** (проверка запроса защиты SCEP).  

   Выберите **Добавить разрешения**, чтобы сохранить эту конфигурацию.  

9. На странице **Разрешения API** выберите **Grant admin consent for Microsoft** (Предоставить согласие администратора для Майкрософт), а затем — **Да**.  
   
   Процесс регистрации приложения в Azure AD завершен.





### <a name="configure-and-deploy-a-scep-certificate-profile"></a>Настройка и развертывание профиля сертификата SCEP
Как администратор создайте профиль сертификата SCEP, предназначенный для пользователей или устройств. Затем назначьте профиль.

- [Создание профиля сертификата SCEP](certificates-profile-scep.md#create-a-scep-certificate-profile)

- [Назначение профиля сертификата](certificates-profile-scep.md#assign-the-certificate-profile)

## <a name="removing-certificates"></a>Удаление сертификатов

При отмене регистрации или очистке устройства сертификаты будут удалены. Отзыв сертификатов не выполняется.

## <a name="third-party-certification-authority-partners"></a>Сторонние центры сертификации партнеров
Следующие сторонние центры сертификации поддерживают Intune:

- [Entrust Datacard](https://go.entrustdatacard.com/pki/intune/)
- [EJBCA — версия с открытым исходным кодом в GitHub](https://github.com/agerbergt/intune-ejbca-connector)
- [EverTrust](https://evertrust.fr/en/products/)
- [GlobalSign](https://downloads.globalsign.com/acton/attachment/2674/f-6903f60b-9111-432d-b283-77823cc65500/1/-/-/-/-/globalsign-aeg-microsoft-intune-integration-guide.pdf)
- [IDnomic](https://www.idnomic.com/)
- [Sectigo](https://sectigo.com/products)
- [DigiCert](https://knowledge.digicert.com/tutorials/microsoft-intune.html)
- [Venafi](https://www.venafi.com/platform/enterprise-mobility)
- [SCEPman](https://azuremarketplace.microsoft.com/marketplace/apps/gluckkanja.scepman)

Если вы являетесь поставщиком стороннего ЦС, заинтересованным в интеграции вашего продукта с Intune, просмотрите руководство по API:

- [Репозиторий GitHub для API SCEP Intune](https://github.com/Microsoft/Intune-Resource-Access/tree/develop/src/CsrValidation)
- [Руководство по API SCEP Intune для сторонних центров сертификации](scep-libraries-apis.md)

## <a name="see-also"></a>См. также

- [Настройка профилей сертификатов](certificates-scep-configure.md)
- [Репозиторий GitHub для API SCEP Intune](https://github.com/Microsoft/Intune-Resource-Access/tree/develop/src/CsrValidation)
- [Руководство по API SCEP Intune для сторонних центров сертификации](scep-libraries-apis.md)
