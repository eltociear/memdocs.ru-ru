---
title: Конечная точка API для хранилища данных Intune
titleSuffix: Microsoft Intune
description: В этой справочной статье описывается структура URL-адресов API хранилища данных Microsoft Intune. Также приведены примеры фильтров.
keywords: Хранилище данных Intune
author: Erikre
ms.author: erikre
manager: dougeby
ms.date: 01/03/2020
ms.topic: reference
ms.service: microsoft-intune
ms.subservice: developer
ms.localizationpriority: medium
ms.technology: ''
ms.assetid: A7A174EC-109D-4BB8-B460-F53AA2D033E6
ms.reviewer: aanavath
ms.suite: ems
search.appverid: MET150
ms.custom: intune-classic
ms.collection: M365-identity-device-management
ms.openlocfilehash: 04521681ee6e262f4634cfc96560a5922ce1b8c0
ms.sourcegitcommit: 3d895be2844bda2177c2c85dc2f09612a1be5490
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 03/13/2020
ms.locfileid: "79360240"
---
# <a name="intune-data-warehouse-api-endpoint"></a>Конечная точка API для хранилища данных Intune

Вы можете использовать API хранилища данных Intune с помощью учетной записи, используя определенные меры управления доступом на основе ролей и учетные данные Azure AD. Позднее вы авторизуете свой клиент REST с помощью Azure AD, используя OAuth 2.0. Наконец, вы сформируете значимый URL-адрес для вызова ресурса хранилища данных.

[!INCLUDE [reports-credential-reqs](../includes/reports-credential-reqs.md)]

## <a name="authorization"></a>Авторизация

Azure Active Directory (Azure AD) использует OAuth 2.0, чтобы предоставить возможность санкционировать доступ к веб-приложениям и веб-API в клиенте Azure AD. Это руководство не привязано к конкретному языку и описывает отправку и получение сообщений HTTP без использования библиотек с открытым исходным кодом. Поток кода проверки подлинности OAuth 2.0 описан в [разделе 4.1](https://tools.ietf.org/html/rfc6749#section-4.1) спецификации OAuth 2.0.

Дополнительные сведения см. в разделе [Разрешение доступа к веб-приложениям с помощью OAuth 2.0 и Azure Active Directory](https://docs.microsoft.com/azure/active-directory/develop/active-directory-protocols-oauth-code).

## <a name="api-url-structure"></a>Структура URL-адресов API

Конечные точки API для хранилища данных считывают сущности для каждого набора. API поддерживает команду **GET** HTTP и подмножество параметров запроса.

URL-адрес для Intune использует следующий формат:  
`https://fef.{location}.manage.microsoft.com/ReportingService/DataWarehouseFEService/{entity-collection}?api-version={api-version}`

> [!NOTE]
> В приведенном выше URL-адресе замените `{location}`, `{entity-collection}` и `{api-version}` на основании сведений, приведенных в таблице ниже.

URL-адрес содержит следующие элементы:

| Элемент | Пример | Описание: |
|-------------------|------------|--------------------------------------------------------------------------------------------------------------------|
| местоположение | msua06 | Базовый URL-адрес можно узнать, просмотрев колонку API хранилища данных на портале Azure. |
| entity-collection | devicePropertyHistories | Имя коллекции сущностей OData. Дополнительные сведения о коллекциях и сущностях в модели данных см. в разделе [Модели данных](reports-ref-data-model.md). |
| api-version | beta | Версия API, используемого для доступа. Дополнительные сведения см. в разделе [Версия](reports-api-url.md#api-version-information). |
| maxhistorydays | 7 | Максимальное число дней хранения журнала для извлечения (необязательно). Этот параметр может быть задан для любой коллекции, но будет действовать только для коллекций, которые содержат `dateKey` как часть свойства ключа. Дополнительную информацию см. в разделе [Фильтры диапазона DateKey](reports-api-url.md#datekey-range-filters). |

## <a name="api-version-information"></a>Сведения о версии API

Теперь вы можете использовать версию 1.0 хранилища данных Intune, задав параметр запроса `api-version=v1.0`. Обновления коллекций в хранилище данных носят аддитивный характер и не нарушают существующие сценарии.

Вы можете самостоятельно оценить новые функциональные возможности хранилища данных с помощью бета-версии. Для ее использования URL-адрес должен содержать параметр запроса `api-version=beta`. Бета-версия позволяет воспользоваться функциями до того, как они станут общедоступными в виде поддерживаемой службы. По мере добавления новых возможностей в Intune поведение и контракты данных в бета-версии могут изменяться. Любые средства ведения отчетов или пользовательский код, зависящие от бета-версии, с выходом обновлений могут начать работать неправильно.

## <a name="odata-query-options"></a>Параметры запроса OData

Текущая версия поддерживает следующие параметры запроса OData: `$filter`, `$select`, `$skip,` и `$top`. В `$filter` может поддерживаться только `DateKey` или `RowLastModifiedDateTimeUTC`, если столбцы применимы, а другие свойства приведут недопустимому запросу.

## <a name="datekey-range-filters"></a>Фильтры диапазона DateKey

Фильтры диапазона `DateKey` могут использоваться для ограничения объема данных для загрузки для некоторых коллекций с `dateKey` в качестве свойства ключа. Фильтр `DateKey` можно использовать для оптимизации производительности службы путем предоставления следующего параметра запроса `$filter`:

1. `DateKey` в `$filter`, используемый отдельно или поддерживающий операторы `lt/le/eq/ge/gt` и присоединяемый к ним с помощью логического оператора `and`, обеспечивает сопоставление с датой начала и (или) датой окончания.
2. `maxhistorydays` передается как пользовательский параметр запроса.<br>

## <a name="filter-examples"></a>Примеры фильтров

> [!NOTE]
> В примерах фильтра подразумевается, что сегодняшняя дата — 21.02.2019.

|                             Фильтр                             |           Оптимизация производительности           |                                          Описание:                                          |
|:--------------------------------------------------------------:|:--------------------------------------------:|:---------------------------------------------------------------------------------------------:|
|    `maxhistorydays=7`                                            |    Полная архивация                                      |    Возврат данных с `DateKey` из промежутка между 20180214 и 20180221.                                     |
|    `$filter=DateKey eq 20180214`                                 |    Полная архивация                                      |    Возврат данных с `DateKey`, равным 20180214.                                                    |
|    `$filter=DateKey ge 20180214 and DateKey lt 20180221`         |    Полная архивация                                      |    Возврат данных с `DateKey` из промежутка между 20180214 и 20180220.                                     |
|    `maxhistorydays=7&$filter=DateKey eq 20180214`                |    Полная архивация                                      |    Возврат данных с `DateKey`, равным 20180214. `maxhistorydays` игнорируется.                            |
|    `$filter=RowLastModifiedDateTimeUTC ge 2018-02-21T23:18:51.3277273Z`                                |    Полная архивация                                       |    Вернуть данные с `RowLastModifiedDateTimeUTC` не меньше `2018-02-21T23:18:51.3277273Z`.                             |
