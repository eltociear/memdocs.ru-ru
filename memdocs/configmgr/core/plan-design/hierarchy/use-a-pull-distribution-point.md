---
title: Точка распространения по запросу
titleSuffix: Configuration Manager
description: Сведения о конфигурациях и ограничениях при использовании точки распространения по запросу в Configuration Manager.
ms.date: 04/24/2020
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: conceptual
ms.assetid: 7d8f530b-1a39-4a9d-a2f0-675b516da7e4
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: c243897a4c52eff04263325b998c4b23d6b3dde4
ms.sourcegitcommit: ad4b3e4874a797b755e774ff84429b5623f17c5c
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/27/2020
ms.locfileid: "82166593"
---
# <a name="use-a-pull-distribution-point-with-configuration-manager"></a>Использование точки распространения по запросу в Configuration Manager

*Область применения: Configuration Manager (Current Branch)*

При передаче содержимого в стандартную точку распространения в консоли Configuration Manager сервер сайта отправляет его в точку распространения. Точка распространения по запросу получает содержимое, скачивая его из исходного расположения так же, как клиент.  

Когда содержимое передается в большое число точек распространения, точки распространения по запросу позволяют снизить нагрузку на сервер сайта. Они также могут ускорить передачу содержимого на каждый сервер. Как правило, компонент диспетчера распространения на сервере сайта отправляет содержимое в каждую точку распространения. При использовании же точек распространения по запросу эта функция с него снимается.  

Вы можете настроить отдельные точки распространения как точки распространения по запросу. Для каждой точки распространения по запросу укажите одну или несколько исходных точек распространения, из которых она может получать содержимое. Точка распространения по запросу может скачивать содержимое только с той точки распространения, которая указана в качестве исходной.

При передаче содержимого в точку распространения по запросу в консоли сервер сайта отправляет ей уведомление. Затем точка распространения по запросу скачивает содержимое из исходной точки распространения. Точка распространения по запросу управляет передачей содержимого, скачивая его из точки распространения, которая уже содержит копию содержимого.  

Точки распространения по запросу поддерживают те же самые конфигурации и функциональные возможности, что и обычные точки распространения. Например, точка распространения по запросу поддерживает:

- конфигурации многоадресной рассылки и PXE;
- Проверка содержимого
- Распространение содержимого по запросу
- обмен данными с клиентами по протоколам HTTP и HTTPS;
- те же варианты сертификатов, что и другие точки распространения;
- возможность управления как по отдельности, так и в составе группы точек распространения.  

Точка распространения по запросу настраивается при установке точки распространения. После создания точки распространения настройте ее как точку распространения по запросу, изменив свойства роли. Дополнительные сведения о включении точки распространения по запросу см. в разделе [Точка распространения по запросу](../../servers/deploy/configure/install-and-configure-distribution-points.md#bkmk_config-pull).  

Конфигурацию точки распространения по запросу можно удалить, изменив свойства точки распространения. При удалении конфигурации точки распространения по запросу она становится обычной точкой распространения. Сервер сайта управляет дальнейшей передачей данных в точку распространения.  

## <a name="distribution-process"></a>Процесс распространения

При передаче содержимого в точку распространения по запросу происходит описанная ниже последовательность событий.

- После передачи содержимого в точку распространения по запросу в консоли компонент "Диспетчер передачи пакетов" на сервере сайта проверяет базу данных сайта, чтобы подтвердить доступность содержимого в исходной точке распространения. Если не удается подтвердить, что содержимое находится в исходной точке распространения для точки распространения по запросу, проверка повторяется каждые 20 минут, пока содержимое не будет доступно.  

- При подтверждении доступности содержимого диспетчер передачи пакетов уведомляет точку распространения по запросу о возможности его загрузки. Если отправить уведомление не удается, повторные попытки выполняются в соответствии с **параметрами повтора** компонента распространения программного обеспечения, которые заданы для точек распространения по запросу. При получении уведомления точка распространения по запросу пытается скачать содержимое из исходных точек распространения.  

- Тогда как точка распространения по запросу скачивает содержимое, диспетчер передачи пакетов опрашивает состояние на основе **параметров опроса состояния**, заданных в компоненте распространения программного обеспечения для точек распространения по запросу.  После завершения скачивания содержимого точка распространения по запросу передает это состояние в точку управления.  

## <a name="configure-site-component-settings"></a>Настройка параметров компонентов сайта

Если вы используете точку распространения по запросу, проверьте и настройте указанные ниже параметры компонентов сайта.  

1. В консоли Configuration Manager перейдите в рабочую область **Администрирование**, разверните узел **Конфигурация сайта** и выберите узел **Сайты**.  

2. Выберите сайт. На ленте щелкните **Настройка компонентов сайта** и выберите пункт **Распространение программного обеспечения**.  

3. Перейдите на вкладку **Точка распространения по запросу**.  

4. В группе **Параметры повтора** проверьте указанные ниже значения.  

    - **Число повторных попыток**. Указывает, сколько раз диспетчер передачи пакетов пытается уведомить точку распространения по запросу о скачивании содержимого. Когда число попыток исчерпано, диспетчер передачи пакетов отменяет операцию передачи. По умолчанию это значение равно 30.  

    - **Задержка перед повтором (в минутах)** . Период времени, в течение которого диспетчер передачи пакетов ожидает, прежде чем выполнить очередную попытку. По умолчанию это значение равно 20.  

5. В группе **Параметры опроса состояния** проверьте указанные ниже значения.  

    - **Количество опросов**. Число попыток, которое диспетчер передачи пакетов предпринимает, чтобы установить связь с точкой распространения по запросу для получения сведений о состоянии задания. Если число попыток исчерпано до завершения задания, диспетчер передачи пакетов отменяет операцию передачи. По умолчанию это значение равно 72.

    - **Задержка перед повтором (в минутах)** . Период времени, в течение которого диспетчер передачи пакетов ожидает, прежде чем выполнить очередную попытку. По умолчанию это значение равно 60.

    > [!NOTE]  
    >  Если диспетчер передачи пакетов отменяет задание из-за того, что число попыток опроса исчерпано, точка распространения по запросу продолжает скачивать содержимое. После завершения этого процесса точка распространения по запросу отправляет соответствующее сообщение о состоянии, а в консоли отражается новое состояние.  

## <a name="limitations"></a>Ограничения

- Облачную точку распространения нельзя настроить как точку распространения по запросу.  

- Роль точки распространения на сервере сайта нельзя настроить как точку распространения по запросу.  

- Конфигурация предварительно подготовленного содержимого переопределяет конфигурацию точки распространения по запросу. Если для точки распространения по запросу включен параметр **Включить эту точку распространения в режиме предварительного копирования содержимого**, она ожидает содержимое. Она не извлекает содержимое из исходной точки распространения. Так же как стандартная точка распространения, для которой включено предварительно подготовленное содержимое, она не получает содержимое с сервера сайта. Дополнительные сведения см. в разделе [Предварительно подготовленное содержимое](manage-network-bandwidth.md#BKMK_PrestagingContent).  

- Точка распространения по запросу не использует конфигурации расписания и пределов скорости. Если ранее установленная точка распространения настраивается в качестве точки распространения по запросу, то конфигурации расписания и пределов скорости сохраняются, но не используются. Если позже удалить конфигурацию точки распространения по запросу, конфигурации расписания и пределов скорости реализуются как ранее настроенные.  

    > [!NOTE]  
    >  Вкладки **Расписание** и **Пределы скорости** отсутствуют в свойствах точки распространения.  

- Точки распространения по запросу не используют параметры, представленные на вкладке **Общие** диалогового окна **Свойства компонента распространения программного обеспечения** для каждого сайта. К ним относятся **Параметры одновременного распространения** и **Параметры попыток при выполнении многоадресной рассылки**.  

- Для передачи содержимого из исходной точки распространения в удаленном лесу установите клиент Configuration Manager в точке распространения по запросу. Кроме того, настройте учетную запись доступа к сети, которая имеет доступ к исходной точке распространения. При включении параметра сайта **Использовать сертификаты, созданные с помощью Configuration Manager, для систем сайтов HTTP** учетная запись доступа к сети не требуется.<!--1358228-->  

- Если точка распространения по запросу также является клиентом Configuration Manager, версия клиента должна совпадать с версией сайта Configuration Manager, на котором установлена точка распространения по запросу. Точка распространения по запросу использует компонент CCMFramework, который является общим для нее и клиента Configuration Manager.  

## <a name="about-source-distribution-points"></a>Сведения об исходных точках распространения  

При настройке точки распространения по запросу укажите одну или несколько исходных точек распространения.  

- В мастере отображаются только те точки распространения, которые могут использоваться в качестве исходных.  

- Точку распространения по запросу можно указать в качестве исходной точки распространения для другой точки распространения по запросу.  

- При использовании консоли Configuration Manager в качестве исходных точек распространения можно указать только точки распространения с поддержкой HTTP.  

- Чтобы указать исходную точку распространения, настроенную для поддержки протокола HTTPS, используйте пакет SDK Configuration Manager. Чтобы использовать исходную точку распространения, для которой настроена поддержка HTTPS, установите клиент Configuration Manager в точке распространения по запросу.  

- Если в удаленном подразделении характеристики подключения к Интернету лучше, а также если необходимо снизить нагрузку на каналы глобальной сети, используйте в качестве источника [облачную точку распространения](use-a-cloud-based-distribution-point.md) в Microsoft Azure. Для взаимодействия с Microsoft Azure точке распространения по запросу требуется подключение к Интернету. Содержимое должно передаваться в исходную облачную точку распространения.<!--1321554-->  

    > [!Note]  
    > За пользование этой возможностью с вашей подписки на Azure взимается плата за хранение данных и доступ к сети. Ознакомьтесь с более подробными сведениями о [затратах на облачные точки распространения](use-a-cloud-based-distribution-point.md#bkmk_cost).  

> [!Tip]  
> При скачивании точкой распространения по запросу содержимого из исходной точки распространения эта точка распространения по запросу учитывается при подсчете клиентов в столбце **Обращения к клиентам (уникальные)** отчета **Сводка по использованию точки распространения** .  

### <a name="source-priorities"></a>Приоритеты источников

- Назначьте приоритет каждой исходной точке распространения по отдельности или назначьте одинаковый приоритет нескольким точкам.  

- Приоритет определяет порядок, в котором точка распространения по запросу запрашивает содержимое из своих исходных точек распространения.  

- Точки распространения по запросу сначала обращаются к исходной точке распространения с наименьшим приоритетом. Если существует несколько исходных точек распространения с одинаковым приоритетом, то точка распространения по запросу случайным образом выбирает одну из них.  

- Если в выбранной исходной точке содержимое недоступно, точка распространения по запросу пытается скачать содержимое из другой точки распространения с таким же приоритетом.  

- Если содержимое отсутствует во всех точках распространения с указанным приоритетом, точка распространения по запросу пытается скачать его из исходной точки распространения со следующим приоритетом. Поиск продолжается, пока содержимое не будет найдено.

- Если содержимое не найдено ни в одной из назначенных исходных точек распространения, то точка распространения по запросу ожидает 30 минут, а затем снова начинает выполнение этой процедуры.  

## <a name="inside-the-pull-distribution-point"></a>Принципы работы точки распространения по запросу

- Для управления передачей содержимого точки распространения по запросу используют компонент **CCMFramework**. Клиент Configuration Manager включает его в себя.  

- При включении точки распространения по запросу сайт устанавливает **pulldp.msi**. Этот установщик также добавляет компонент CCMFramework. Платформа не требует установки клиента Configuration Manager.  

- После установки точки распространения по запросу для работы она в первую очередь использует службу **CCMExec**.  

- Когда точка распространения по запросу передает содержимое, она использует **фоновую интеллектуальную службу передачи** (BITS), встроенную в ОС Windows. Точка распространения по запросу не требует устанавливать расширение BITS для сервера IIS.<!--sms.503672 -Clarified BITS use-->

- Сведения о работе см. в следующих файлах журнала в точке распространения по запросу:  

  - **DataTransferService.log**
  - **PullDP.log**

> [!TIP]
> Если после добавления точки распространения по запросу в файлах журнала отображаются ошибки HTTP 403, внесите приведенные ниже изменения.
>
> 1. В исходной точке распространения задайте следующий параметр реестра: `HKLM\SYSTEM\CurrentControlSet\Control\SecurityProviders\SCHANNEL, ClientAuthTrustMode = 2 (REG_DWORD)`
> 1. Перезапустите сервер исходной точки распространения.
>
> Затем точка распространения по запросу должна начать скачивание содержимого из источника. Дополнительные сведения об этом разделе реестра см. в статье [Общие сведения о протоколе TLS — SSL (Schannel SSP)](https://docs.microsoft.com/windows-server/security/tls/what-s-new-in-tls-ssl-schannel-ssp-overview).<!-- SCCMDocs#1973 -->

## <a name="see-also"></a>См. также  

[Основные принципы управления содержимым](fundamental-concepts-for-content-management.md)
