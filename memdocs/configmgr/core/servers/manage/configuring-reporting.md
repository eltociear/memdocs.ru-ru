---
title: Настройка отчетов
titleSuffix: Configuration Manager
description: Сведения о настройке ведения отчетов в иерархии Configuration Manager, включая информацию о службах SQL Server Reporting Services.
ms.date: 04/01/2020
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: conceptual
ms.assetid: 55ae86a7-f0ab-4c09-b4da-89cd0e7fa0e0
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 1b7ada6f54a7642817a321937a4d7128994d5538
ms.sourcegitcommit: 2f9999994203194a8c47d8daa6406c987a002e02
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/24/2020
ms.locfileid: "83823985"
---
# <a name="configure-reporting-in-configuration-manager"></a>Настройка отчетов в Configuration Manager

*Область применения: Configuration Manager (Current Branch)*

Перед созданием, изменением и запуском отчетов в консоли Configuration Manager необходимо выполнить ряд задач по их настройке. Для настройки отчетов в иерархии Configuration Manager используйте информацию из этой статьи.  

Перед установкой и настройкой SQL Server Reporting Services в иерархии ознакомьтесь со сведениями в следующих статьях, посвященных отчетам в Configuration Manager.  

- [Общие сведения о ведении отчетов](introduction-to-reporting.md)  

- [Планирование отчетов](planning-for-reporting.md)  

## <a name="sql-server-reporting-services"></a>Службы SQL Server Reporting Services

Службы SQL Server Reporting Services — это серверная платформа для формирования отчетов, которая предоставляет комплексные функции создания отчетов для различных типов источников данных. Точка служб отчетов в Configuration Manager взаимодействует со службами SQL Server Reporting Services для:

- копирования отчетов Configuration Manager в указанную папку отчетов;
- настройки параметров служб Reporting Services;
- настройки параметров безопасности служб Reporting Services.

При запуске отчета компонент Reporting Services подключается к базе данных сайта Configuration Manager для получения данных.  

Перед установкой точки служб отчетов на сайте Configuration Manager необходимо установить и настроить службы SQL Server Reporting Services в целевой системе сайта. Дополнительные сведения см. в статье [Установка служб SQL Server Reporting Services (2017 или более поздней версии)](https://docs.microsoft.com/sql/reporting-services/install-windows/install-reporting-services).  

### <a name="verify-sql-server-reporting-services-installation"></a>Проверка установки экземпляра SQL Server Reporting Services

Следующая процедура используется для проверки правильности установки и выполнения служб SQL Server Reporting Services.

1. В системе сайта перейдите в меню **Пуск** и выберите пункт **Диспетчер конфигурации служб Reporting Services**. Вы можете найти его в разделе **Средства настройки** группы **Microsoft SQL Server**.

2. В окне **Соединение конфигурации служб Reporting Services** введите имя сервера, на котором размещаются службы SQL Server Reporting Services. Выберите экземпляр SQL Server, на котором установлены службы SQL Server Reporting Services. Затем выберите **Соединить**, чтобы открыть диспетчер конфигурации служб Reporting Services.  

3. Проверьте, задано ли на странице **Состояние сервера отчетов** для параметра **Состояние службы отчетов** значение **Запущена**. Если указано другое состояние, выберите **Пуск**.  

4. На странице **URL-адрес веб-службы** выберите URL-адрес в поле **URL-адреса веб-службы сервера отчетов**. Это действие приведет к проверке соединения с папкой отчетов. Браузер может запросить учетные данные. Убедитесь, что веб-страница успешно открывается.

5. Проверьте, задано ли на странице **База данных** для параметра **Режим сервера отчетов** значение **Основной**.  

6. На странице **URL-адрес диспетчера отчетов** выберите URL-адрес в поле **Идентификация веб-сайта диспетчера отчетов**. Это действие приведет к проверке соединения с виртуальным каталогом для диспетчера отчетов. Браузер может запросить учетные данные. Убедитесь, что веб-страница успешно открывается.

    > [!NOTE]  
    > Для создания отчетов в Configuration Manager не требуется диспетчер отчетов Reporting Services. Он необходим только тогда, когда нужно запустить отчеты в браузере или управлять ими с помощью диспетчера отчетов.  

7. Выберите **Выход**, чтобы закрыть диспетчер конфигурации служб Reporting Services.  

## <a name="configure-reporting-to-use-report-builder-30"></a>Настройка отчетов для использования построителя отчетов 3.0

1. На компьютере с консолью Configuration Manager откройте редактор реестра Windows.  

2. Перейдите к `HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\ConfigMgr10\AdminUI\Reporting`.

3. Откройте ключ **ReportBuilderApplicationManifestName**, чтобы изменить значение.  

4. Измените значение на `ReportBuilder_3_0_0_0.application`, а затем выберите **ОК**, чтобы сохранить.

5. Закройте редактор реестра Windows.  

## <a name="install-a-reporting-services-point"></a>Установка точки служб отчетов

Установите точку служб отчетов на сайте, чтобы управлять находящимися там отчетами. Точка служб отчетов:

- копирует папки отчетов и отчеты в Microsoft SQL Server Reporting Services;
- применяет политику безопасности для отчетов и папок;
- задает параметры конфигурации в Reporting Services.

### <a name="requirements-and-limitations"></a>Требования и ограничения

Чтобы просматривать отчеты или управлять ими в консоли Configuration Manager, вам потребуется точка служб отчетов. Настройте эту роль системы сайта на сервере с помощью Microsoft SQL Server Reporting Services. Дополнительные сведения см. в статье [Необходимые условия для ведения отчетов в System Center Configuration Manager](prerequisites-for-reporting.md).  

- При выборе сайта для установки точки служб отчетов пользователи, которые будут иметь доступ к отчетам, должны находиться в той же области безопасности, что и сайт, на котором установлена эта роль.  

- После установки точки служб отчетов в системе сайта не изменяйте URL-адрес сервера отчетов.

    Например, вы создаете точку служб отчетов. Затем вы изменяете URL-адрес сервера отчетов в диспетчере конфигурации служб Reporting Services. Консоль Configuration Manager продолжает использовать старый URL-адрес. Вы не можете запускать, редактировать или создавать отчеты из консоли.

    Если необходимо изменить URL-адрес сервера отчетов, сначала удалите существующую точку служб отчетов. Измените URL-адрес, а затем переустановите точку служб отчетов.  

- Устанавливая точку служб отчетов, укажите [учетную запись точки служб отчетов](../../plan-design/hierarchy/accounts.md#reporting-services-point-account). Чтобы пользователи из других доменов могли запускать отчет, создайте двустороннее доверие между доменами. В противном случае при запуске отчета возникнет ошибка.

### <a name="install-the-reporting-services-point-on-a-site-system"></a><a name="bkmk_install" /> Установка точки служб отчетов в системе сайта  

Дополнительные сведения о настройке систем сайта см. в статье [Установка ролей системы сайта для System Center Configuration Manager](../deploy/configure/install-site-system-roles.md).  

1. В консоли Configuration Manager перейдите в рабочую область **Администрирование**, разверните узел **Конфигурация сайта** и выберите узел **Серверы и роли системы сайта**.  

1. Добавьте точку служб отчетов на новый или существующий сервер системы сайта:  

    - *Новая система сайта*. На вкладке **Главная** на ленте в группе **Создать** выберите **Создать сервер системы сайта**. Откроется **мастер создания сервера системы сайта** .  

    - *Существующая система сайта*. Выберите целевой сервер. На вкладке **Главная** на ленте в группе **Сервер** выберите **Add Site System Role** (Добавить роль системы сайта). Откроется **мастер добавления ролей систем сайта** .  

1. На странице **Общие** укажите общие параметры для сервера системы сайта. При добавлении точки служб отчетов на существующий сервер проверьте ранее настроенные значения.  

1. На странице **Выбор системной роли** выберите **Точка служб отчетов** в списке доступных ролей и нажмите кнопку **Далее**.  

1. На странице **Точка служб отчетов** настройте следующие параметры.  

    - **Имя сервера базы данных сайта**. Укажите имя сервера, на котором находится база данных сайта Configuration Manager. Как правило, мастер получает полное доменное имя (FQDN) сервера. Для указания экземпляра базы данных используйте формат &lt;*имя_сервера*>\&lt;*имя_экземпляра*>. Например, `sqlserver\named1`.

    - **Имя базы данных**. Укажите имя базы данных сайта Configuration Manager. Выберите **Проверить**, чтобы подтвердить, что мастер имеет доступ к базе данных сайта.  

        > [!IMPORTANT]  
        > Учетная запись, используемая для создания точки служб отчетов, должна иметь доступ на **чтение** к базе данных сайта. В случае сбоя проверки соединения отображается красный символ предупреждения. Контекстно-зависимый текст, который появляется при наведении на значок, содержит сведения о сбое. Устраните причину сбоя и снова выберите **Проверка**.  

    - **Имя папки**. Укажите имя папки, которую нужно создать и использовать для отчетов Configuration Manager в Reporting Services.  

    - **Экземпляр сервера Reporting Services**. Выберите экземпляр SQL Server для служб Reporting Services. Если на этой странице нет ни одного экземпляра, убедитесь, что службы SQL Server Reporting Services установлены, настроены и запущены.  

        > [!IMPORTANT]  
        > Configuration Manager устанавливает соединение с инструментарием WMI в контексте текущего пользователя в выбранной системе сайта. Это соединение используется для извлечения экземпляра SQL Server для служб Reporting Services. Текущий пользователь должен иметь доступ на **чтение** к инструментарию WMI в системе сайта. В противном случае получить экземпляры Reporting Services не удастся.  

    - **Учетная запись точки служб отчетов**. Щелкните **Задать**, а затем выберите нужную учетную запись. Эта учетная запись точки служб отчетов используется службами SQL Server Reporting Services для подключения к базе данных сайта Configuration Manager. Это подключение используется для извлечения данных для отчета. Выберите **Существующая учетная запись**, чтобы указать учетную запись пользователя Windows, ранее настроенную в качестве учетной записи Configuration Manager. Выберите **Новая учетная запись**, чтобы указать учетную запись пользователя Windows, которая в данный момент не настроена для использования. Configuration Manager автоматически предоставит указанному пользователю доступ к базе данных сайта.  

        Учетная запись, используемая для запуска служб Reporting Services, должна входить в локальную группу безопасности домена **Группа авторизации доступа Windows**. Это предоставляет учетной записи **разрешение на чтение** для атрибута **tokenGroupsGlobalAndUniversal** для всех объектов пользователей в домене. Чтобы запустить отчет, нужно установить двустороннее доверие между доменом пользователей и доменом, в котором находится учетная запись точки служб отчетов.

        Учетная запись пользователя Windows и пароль зашифрованы и хранятся в базе данных служб Reporting Services. С помощью этой учетной записи и пароля службы Reporting Services получают данные для отчетов из базы данных сайта.  

        > [!IMPORTANT]  
        > Указанная учетная запись должна обладать разрешениями на **локальный вход в систему** на сервере, на котором размещена база данных служб Reporting Services.  

1. Завершите работу мастера.

После завершения работы мастера Configuration Manager создает папки отчетов в службах Reporting Services. Затем он копирует свои отчеты в указанные папки отчетов.  

> [!TIP]  
> Чтобы указать только те системы сайта, в которых находится роль сайта точки служб отчетов, щелкните правой кнопкой мыши **Серверы и роли системы сайта**, а затем выберите пункт **Точка служб отчетов**.  

### <a name="languages-for-reports"></a><a name="bkmk_languages" /> Языки для отчетов

<!-- SCCMDocs#1067 -->

Когда Configuration Manager создает папки отчетов и копирует отчеты на сервер отчетов, он определяет соответствующий язык для объектов.

- Создание папок отчетов и копирование отчетов:

  - Объекты создаются с использованием языкового стандарта ОС сервера сайта.

  - Если определенный языковой пакет недоступен, по умолчанию используется английский (ENU).

- Просмотр отчетов в веб-браузере:

  - Имена папок и отчетов: тот же языковой стандарт, что и у сервера сайта.
  
  - Содержимое отчета: динамическое в зависимости от языкового стандарта браузера.

- Просмотр отчетов в консоли Configuration Manager:

  - Имена папок и отчетов: динамические в зависимости от языкового стандарта консоли.
  
  - Содержимое отчета: динамическое в зависимости от языкового стандарта консоли.

При установке точки служб отчетов на сайте без языковых пакетов отчеты устанавливаются с английским языком. Если установить языковой пакет после установки точки служб отчетов, необходимо удалить и повторно установить точку служб отчетов, чтобы отчеты были доступны на языке соответствующего языкового пакета.  

Дополнительные сведения см. в статье [Языковые пакеты в Configuration Manager](../deploy/install/language-packs.md).

### <a name="file-installation-and-report-folder-security-rights"></a>Установка файла и права безопасности папки отчетов

Configuration Manager выполняет следующие действия по установке точки служб отчетов и настройке служб Reporting Services.  

> [!IMPORTANT]  
> Сайт выполняет эти действия в контексте учетной записи, настроенной для службы SMS_Executive. Как правило, это учетная запись локальной системы сервера сайта.  

- Устанавливает роль сайта точки служб отчетов.  

- Создает источник данных в службах Reporting Services с использованием сохраненных учетных данных, указанных в мастере. Это учетная запись пользователя Windows и пароль, используемые службами Reporting Services для подключения к базе данных сайта во время запуска отчетов.  

- Создает корневую папку Configuration Manager в службах Reporting Services.  

- Добавляет роли безопасности **Пользователи отчетов Configuration Manager** и **Администраторы отчетов Configuration Manager** в службы Reporting Services.  

- Создает вложенные папки и развертывает отчеты Configuration Manager из `%ProgramFiles%\SMS_SRSRP` на сервере сайта в службы Reporting Services.  

- Добавляет роль **Пользователи отчетов Configuration Manager** в службах Reporting Services для корневых папок всех учетных записей пользователей в Configuration Manager, имеющих права на **чтение сайта**.  

- Добавляет роль **Администраторы Configuration Manager** в службах Reporting Services для корневых папок всех учетных записей пользователей в Configuration Manager, имеющих права на **изменение сайта**.  

- Получает сопоставление между папками отчетов и защищенными типами объектов Configuration Manager. Configuration Manager поддерживает это сопоставление в базе данных сайта.  

- Настраивает следующие права для пользователей в Configuration Manager для конкретных папок отчетов в службах Reporting Services.  

  - Добавляет пользователей и назначает роль **Пользователи отчетов Configuration Manager** для связанной папки отчетов пользователям с правами администратора, имеющим разрешения на **запуск отчетов** для объекта Configuration Manager.  

  - Добавляет пользователей и назначает роль **Администраторы отчетов Configuration Manager** для связанной папки отчетов пользователям с правами администратора, имеющим разрешения на **изменение отчетов** для объекта Configuration Manager.  

Configuration Manager подключается к службам Reporting Services и задает разрешения пользователям для корневых и конкретных папок Configuration Manager и служб Reporting Services. После первоначальной установки точки служб отчетов Configuration Manager каждые 10 минут подключается к службам Reporting Services, чтобы проверить соответствие прав пользователей, настроенных в папках отчетов, правам, заданным пользователям Configuration Manager. В случае добавления пользователей или изменения прав пользователей в папке отчета с помощью диспетчера отчетов служб Reporting Services Configuration Manager перезаписывает изменения с помощью ролевых назначений, хранящихся в базе данных сайта. Configuration Manager также удаляет пользователей, у которых нет прав на работу с отчетами в Configuration Manager.  

### <a name="reporting-services-security-roles"></a>Роли безопасности Reporting Services

Когда Configuration Manager устанавливает точку служб отчетов, в службы Reporting Services добавляются следующие роли безопасности:  

- **Пользователи отчетов ConfigMgr**. Пользователи, которым назначена данная роль безопасности, могут только выполнять отчеты Configuration Manager.  

- **Администраторы отчетов ConfigMgr**. Пользователи, которым назначена данная роль безопасности, могут выполнять все задачи, касающиеся отчетов, в Configuration Manager.  

## <a name="verify-installation"></a><a name="bkmk_verify"></a> Проверка установки

Проверьте установку точки служб отчетов, просмотрев определенные сообщения о состоянии и записи в файле журнала. Следующая процедура используется для проверки успешной установки точки служб отчетов.  

> [!Note]  
> Эту процедуру можно пропустить, если отчеты отображаются во вложенной папке **Отчеты** узла **Создание отчетов** в рабочей области **Мониторинг** консоли Configuration Manager.

### <a name="verify-installation-by-status-message"></a>Проверка установки по сообщению о состоянии

1. В консоли Configuration Manager перейдите в рабочую область **Мониторинг**, разверните раздел **Состояние системы** и выберите узел **Состояние компонента**.  

1. Выберите компонент **SMS_SRS_REPORTING_POINT**.  

1. На вкладке **Главная** на ленте в группе **Компонент** щелкните **Показать сообщения**, а затем выберите **Все**.  

1. Укажите дату и время, соответствующие периоду, предшествующему установке точки служб отчетов, и нажмите кнопку **ОК**.  

1. Проверьте идентификатор сообщения о состоянии **1015**. В этом сообщении о состоянии указано, что точка служб отчетов была успешно установлена.

### <a name="verify-installation-by-log-file"></a>Проверка установки по файлу журнала

Откройте файл **Srsrp.log**, расположенный в каталоге **Журналы** пути установки Configuration Manager. Найдите строку `Installation was successful`.

Просмотрите этот файл журнала, начиная с момента успешной установки точки служб отчетов. Убедитесь, что папки отчета были созданы, отчеты были развернуты, а для каждой папки была утверждена политика безопасности. После последней строки подтверждений политики безопасности найдите строку `Successfully checked that the SRS web service is healthy on server`.  

## <a name="configure-a-certificate-to-author-reports"></a>Настройка сертификата для создания отчетов

Существует множество методов создания отчетов в SQL Server Reporting Services. Когда вы создаете или редактируете отчеты в консоли Configuration Manager, Configuration Manager открывает построитель отчетов для использования в качестве среды разработки. Независимо от способа создания отчетов Configuration Manager, для проверки подлинности сервера на сервере базы данных сайта необходим самозаверяющий сертификат.

> [!NOTE]  
> Дополнительные сведения о создании отчетов с помощью SQL Server Reporting Services см. в статье [Report Builder authoring environment (SSRS)](https://docs.microsoft.com/sql/reporting-services/tools/report-builder-authoring-environment-ssrs) (Среда разработки построителя отчетов (службы SSRS)).  

Configuration Manager автоматически устанавливает сертификат на сервере сайта, а также на ролях поставщика SMS. Вы можете создавать или изменять отчеты из консоли Configuration Manager, когда она запущена на одном из этих серверов.

При создании или изменении отчетов из консоли Configuration Manager на другом компьютере экспортируйте сертификат с сервера сайта. Понятное имя конкретного сертификата — это полное доменное имя сервера сайта в хранилище сертификатов **доверенных лиц** для локального компьютера. Добавьте этот сертификат в хранилище сертификатов **доверенных лиц** на компьютере, на котором запущена консоль Configuration Manager.  

## <a name="modify-reporting-services-point-settings"></a>Изменение параметров точки служб отчетов

После установки этой роли можно настроить параметры подключения к базе данных сайта и проверки подлинности в свойствах точки служб отчетов.

1. В консоли Configuration Manager перейдите в рабочую область **Администрирование**, разверните узел **Конфигурация сайта**, а затем выберите узел **Серверы и роли системы сайта**.  

    > [!TIP]  
    > Чтобы указать только те системы сайта, в которых находится точка служб отчетов, щелкните правой кнопкой мыши **Серверы и роли системы сайта** и выберите пункт **Точка служб отчетов**.  

1. Выберите систему сайта, в которой размещена точка служб отчетов. Затем в области сведений выберите роли системы сайта **Точка служб отчетов**.

1. На вкладке **Роль сайта** на ленте в группе **Свойства** выберите **Свойства**.  

1. В диалоговом окне **Свойства точки служб отчетов** можно настроить следующие параметры.  

    - **Имя сервера базы данных сайта**.

    - **Имя базы данных**.

    - **Учетная запись пользователя**.

1. Нажмите кнопку **ОК**, чтобы сохранить изменения и закрыть окно свойств.  

Дополнительные сведения об этих параметрах см. в описании в разделе [Установка точки служб отчетов в системе сайта](#bkmk_install).

## <a name="power-bi-report-server"></a>Сервер отчетов Power BI

Начиная с версии 2002, можно интегрировать отчеты с сервером отчетов Power BI. Дополнительные сведения о настройке см. в статье [Интеграция с сервером отчетов Power BI](powerbi-report-server.md).

## <a name="upgrade-sql-server"></a>Обновление SQL Server

Чтобы обновить SQL Server и SQL Server Reporting Services, сначала удалите точку служб отчетов с сайта. После обновления SQL Server переустановите точку служб отчетов в Configuration Manager.

Если вы не выполните этот процесс, при запуске или изменении отчетов из консоли Configuration Manager будут отображаться ошибки. Вы можете продолжать запускать и изменять отчеты из веб-браузера.  

## <a name="configure-report-options"></a>Настройка параметров отчетов

Вы можете выбрать точку служб отчетов по умолчанию, которая используется для управления отчетами. На сайте может быть несколько точек служб отчетов, но для управления отчетами используется только сервер по умолчанию. Используйте следующую процедуру для настройки параметров вашего сайта.  

1. В консоли Configuration Manager перейдите к рабочей области **Мониторинг**, разверните пункт **Отчеты** и выберите узел **Отчеты**.  

1. На вкладке **Главная** на ленте в группе **Параметры** выберите **Параметры отчета**.  

1. Выберите в списке сервер отчетов по умолчанию, а затем нажмите кнопку **ОК**.

Если в списке не отображаются серверы, убедитесь, что на сайте установлена и настроена точка служб отчетов. Дополнительные сведения см. в разделе [Проверка установки точки служб отчетов](#bkmk_verify).

Убедитесь, что на вашем компьютере установлена версия построителя отчетов SQL Server, соответствующая версии SQL Server, которая используется для сервера отчетов. В противном случае появится ошибка, сервер отчетов по умолчанию не сохранится и вы не сможете создавать или редактировать отчеты.<!-- SCCMDocs#791 -->

## <a name="next-steps"></a>Дальнейшие шаги

[Использование и обслуживание отчетов](operations-and-maintenance-for-reporting.md)
