---
title: Высокий уровень доступности
titleSuffix: Configuration Manager
description: Узнайте, как развернуть Configuration Manager с помощью параметров, обеспечивающих высокий уровень доступности.
ms.date: 11/29/2019
ms.prod: configuration-manager
ms.technology: configmgr-core
ms.topic: conceptual
ms.assetid: 1a38421d-24c1-4fef-bf6c-42fce53109ac
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: cf8714aff7235736628d44238561eea82b896698
ms.sourcegitcommit: 1442a4717ca362d38101785851cd45b2687b64e5
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 04/23/2020
ms.locfileid: "82073319"
---
# <a name="high-availability-options-for-configuration-manager"></a>Способы обеспечения высокой доступности в Configuration Manager

*Область применения: Configuration Manager (Current Branch)*

В этой статье содержатся сведения о развертывании Configuration Manager с помощью параметров, обеспечивающих высокий уровень доступности.

Высокую доступность поддерживают следующие возможности Configuration Manager.

- Любой автономный первичный сайт можно настраивать с дополнительным сервером сайта в пассивном режиме.  

- Можно настроить группу доступности SQL Server AlwaysOn для базы данных сайта на первичных сайтах и сайте центра администрирования.

- Сайты поддерживают работу с множеством экземпляров ролей системы сайта, предоставляющих клиентам важные компоненты. Например, точки управления и распространения.  

- Сайты центра администрирования и первичные сайты поддерживают резервное копирование базы данных сайта. В базе данных сайта хранятся все конфигурации для сайтов и клиентов. Эти данные конфигурации являются общими для сайтов в иерархии.  

- Встроенные варианты восстановления позволяют сократить время простоя сервера. Эти дополнительные варианты упрощают восстановление при наличии иерархии с сайтом центра администрирования.  

- Клиенты могут автоматически устранять типичные проблемы без вмешательства администратора.  

- Сайты генерируют оповещения о клиентах, не представивших последние данные, тем самым предупреждая администраторов о потенциальных проблемах.  

- Configuration Manager предоставляет несколько встроенных ролей и панелей мониторинга. С их помощью можно выявлять проблемы и неблагоприятные тенденции, прежде чем они начнут создавать помехи в работе серверов или клиентов.  

Configuration Manager содержит несколько функций, которые позволяют выполнять действия в режиме, близком к реальному времени. Если эти функции крайне важны для соблюдения бизнес-требований, спланируйте и настройте сайты и иерархии для обеспечения высокой доступности. Пример.  

- [Действия уведомления клиента](../../../clients/manage/manage-clients.md), такие как перезагрузка, запуск проверок Защитником Windows или удаленный рабочий стол.  

- Сообщения на основе состояния для мониторинга функций, таких как обновления программного обеспечения и защита конечных точек.

- [Создание и запуск скриптов PowerShell из консоли Configuration Manager](../../../../apps/deploy-use/create-deploy-scripts.md)

- [CMPivot](../../manage/cmpivot.md)

Другие функции Configuration Manager не предоставляют возможности работы в режиме реального времени. В их число входят параметры клиента, инвентаризация оборудования и программного обеспечения, развертывания программного обеспечения и параметры соответствия требованиям. Следует учитывать, что они будут работать с некоторой задержкой данных. Обычно в большинстве сценариев временное прерывание обслуживания не становится серьезной проблемой. Сконфигурировав сайты и иерархию с учетом соображений высокой доступности, можно свести к минимуму простои, обеспечить непрерывную автономию в работе и высокое качество обслуживания.  

Например, клиенты Configuration Manager обычно работают автономно в соответствии с известными расписаниям и параметрами работы, а также расписаниями отправки данных на сайт для обработки.  

- Когда клиенты не могут связаться с сайтом, они кэшируют данные для отправки до момента, пока не станет возможной связь с сайтом.  

- Клиенты, которым не удается связаться с сайтом, продолжают работать. Они используют последние известные расписания и кэшированные сведения до тех пор, пока не свяжутся с сайтом и не начнут получать новые политики. Например, клиент может оставить ранее загруженное приложение, которое необходимо запустить или установить.

- Сайт отслеживает свои системы и клиенты для применения периодических обновлений состояния. Если эти компоненты не удается зарегистрировать, он может создавать оповещения.  

- Встроенные отчеты позволяют получить представление о текущей работе и тенденциях, а также о работе в прошедшие периоды. Наконец, Configuration Manager поддерживает сообщения о состоянии, которые предоставляют информацию о текущей работе почти в реальном времени.  


## <a name="high-availability-for-sites-and-hierarchies"></a><a name="bkmk_snh"></a> Высокая доступность для сайтов и иерархий  

### <a name="use-a-site-server-in-passive-mode"></a>Использование сервера сайта в пассивном режиме

Дополнительный сервер сайта следует устанавливать в *пассивном* режиме для автономного первичного сайта. Сервер сайта в пассивном режиме — это дополнение к существующему серверу сайта, который работает в *активном* режиме. Сервер сайта в пассивном режиме готов к использованию в любой момент, когда это необходимо. Дополнительные сведения см. в статье [Высокая доступность сервера сайта](site-server-high-availability.md).  

### <a name="use-a-remote-content-library"></a>Использование удаленной библиотеки содержимого

Библиотеку содержимого сайта следует переместить в удаленное расположение, которое является хранилищем с высоким уровнем доступности. Эта функция является обязательной для обеспечения высокой доступности сервера сайта. Дополнительные сведения см. в статье [Библиотека содержимого](../../../plan-design/hierarchy/the-content-library.md#bkmk_remote).

### <a name="centralize-content-sources"></a>Централизация источников содержимого

Для всего содержимого программного обеспечения в Configuration Manager требуется располагать источник пакета в сети. В качестве общего места размещения источника пакета для всего содержимого используйте централизованное высокодоступное хранилище.

### <a name="use-a-sql-server-always-on-availability-group-to-host-the-site-database"></a>Использование группы доступности SQL Server AlwaysOn для размещения базы данных сайта

Разместите базу данных сайта на первичных сайтах и сайте центра администрирования в группах доступности SQL Server AlwaysOn. Дополнительные сведения см. в статье [Подготовка к использованию групп доступности SQL Server AlwaysOn](sql-server-alwayson-for-a-highly-available-site-database.md).  

### <a name="use-a-sql-server-cluster-to-host-the-site-database"></a>Использование кластера SQL Server для размещения базы данных сайта

Используя кластер SQL Server для размещения базы данных на сайте центра администрирования или первичном сайте, вы пользуетесь средствами обеспечения отказоустойчивости, встроенными в SQL Server.  

Вторичные сайты не могут использовать кластер SQL Server и не поддерживают резервное копирование или восстановление своей базы данных. Восстановление вторичного сайта производится путем его переустановки с родительского первичного сайта.  

### <a name="deploy-a-hierarchy-of-sites-with-a-central-administration-site-and-one-or-more-child-primary-sites"></a>Развертывание иерархии сайтов с сайтом центрального администрирования и одним или несколькими дочерними первичными сайтами

Эта конфигурация способна обеспечить устойчивость к сбоям, когда сайты осуществляют управление перекрывающимися сегментами сети. В такой конфигурации возможен еще один вариант восстановления — использовать информацию из общей базы данных на другом сайте для перестроения базы данных восстанавливаемого сайта. Используйте этот вариант для замены испорченной или недоступной резервной копии сбойной базы данных сайта.  

### <a name="create-regular-backups-at-central-administration-sites-and-primary-sites"></a>Регулярное создание резервных копий на сайтах центра администрирования и первичных сайтах

Создание и тестирование регулярной резервной копии сайта гарантирует наличие данных, необходимых для восстановления сайта. Вы также можете восстановить сайт в кратчайшие сроки.  

### <a name="install-multiple-instances-of-site-system-roles"></a>Установка нескольких экземпляров ролей системы сайта

При установке нескольких экземпляров критически важных ролей системы вы предоставляете клиентам дополнительные точки доступа. Например, несколько точек управления и распространения обеспечивают избыточность службы в случае, если определенный сервер находится в автономном режиме.  

### <a name="install-multiple-instances-of-the-sms-provider-at-a-site"></a>Установка на сайте нескольких экземпляров поставщика SMS

Поставщик SMS представляет собой точку административного доступа для одной или нескольких консолей Configuration Manager. Устанавливая несколько поставщиков SMS, вы можете обеспечить дополнительные точки доступа для администрирования сайта и иерархии.  


## <a name="high-availability-for-site-system-roles"></a><a name="bkmk_ssr"></a> Высокий уровень доступности для ролей системы сайта

На каждом сайте развертываются роли системы сайта для оказания требуемых услуг клиентам этого сайта. База данных содержит информацию о конфигурации сайта и всех клиентов. Используйте один или несколько предусмотренных вариантов для обеспечения высокой доступности базы данных сайта, а при необходимости — также для восстановления сайта и его базы данных.  

### <a name="redundancy-for-important-site-system-roles"></a>Избыточность важных ролей системы сайта

- Точка веб-службы каталога приложений  

- Точка веб-сайта каталога приложений  

- Точка распространения  

- Точка управления  

- Точка обновления программного обеспечения  

- точка миграции состояния,  

Для обеспечения избыточности отчетов о сайтах и клиентах установите несколько экземпляров роли точки служб отчетов.

Для обеспечения отказоустойчивости используйте PowerShell для установки роли системы сайта "Точка обновления программного обеспечения" в кластере балансировки сетевой нагрузки Windows (NLB).  

### <a name="built-in-site-backup"></a>Встроенная задача резервного копирования сайта

Configuration Manager имеет встроенную задачу резервного копирования, позволяющую регулярно создавать резервные копии сайта и критически важной информации. Кроме того, программа установки Configuration Manager поддерживает действия по восстановлению сайта, помогая вернуть сайт к работе.  

### <a name="publishing-to-active-directory-domain-services-and-dns"></a>Публикация в доменных службах Active Directory и службе DNS

Настройте каждый сайт для публикации своих данных в доменных службах Active Directory и DNS. Такая публикация позволит клиентам определять самый доступный сервер в сети. Клиенты также используют ее для определения готовности новых серверов системы сайта предоставлять важные службы, такие как точки управления.  

### <a name="sms-provider-and-configuration-manager-console"></a>Поставщик SMS и консоль Configuration Manager

Configuration Manager поддерживает установку нескольких поставщиков SMS (каждый на отдельном сервере) для предоставления нескольких точек доступа консоли. Если один сервер поставщика SMS находится в автономном режиме, можно по-прежнему просматривать сайты и клиенты и управлять ими.  

Когда консоль Configuration Manager подключается к сайту, она соединяется с одним из экземпляров поставщика SMS на этом сайте. Экземпляр поставщика SMS выбирается случайным образом. Если выбранный поставщик SMS недоступен, есть следующие варианты.  

- Повторное подключение консоли к сайту. Каждому новому запросу на подключение случайным образом назначается экземпляр поставщика SMS. Вполне возможно, что новому подключению будет назначен доступный экземпляр.  

- Подключите консоль к другому сайту Configuration Manager и управляйте конфигурацией через это подключение. При этом возникнет небольшая задержка изменения конфигурации, не превышающая нескольких минут. После того как поставщик SMS для данного сайта станет доступным, повторно подключите консоль Configuration Manager непосредственно к управляемому сайту.  

Установите консоль Configuration Manager на нескольких компьютерах, чтобы с ней могли работать администраторы. Каждый поставщик SMS поддерживает подключения нескольких консолей.  

### <a name="management-point"></a>Точка управления

Установите несколько точек управления в каждом первичном сайте и обеспечьте для сайтов возможность публиковать данные о сайте в инфраструктуре Active Directory и службе DNS.  

Наличие нескольких точек управления помогает сбалансировать нагрузку на отдельную точку управления от множества клиентов. Также рекомендуется установить одну или несколько реплик базы данных для точек управления. Эта конфигурация уменьшает число операций с интенсивным использованием процессора для точки управления. Она также повышает доступность этой важной роли системы сайта.  

Вторичные сайты поддерживают установку только одной точки управления, которая должна находиться на сервере вторичного сайта. Считается, что точки управления на вторичных сайтах не имеют конфигурации с высокой доступностью.  

> [!NOTE]  
> Устройства, управляемые с помощью локального управления мобильными устройствами, подключаются только к одной точке управления на первичном сайте. Точка управления назначается Configuration Manager во время регистрации мобильного устройства и затем не меняется. При установке нескольких точек управления и включении нескольких точек для мобильных устройств точка управления, назначаемая мобильному устройству, не детерминирована.  
>
> Если точка управления, которую использует клиент на мобильном устройстве, становится недоступной, нужно устранить проблему с ней или очистить и повторно зарегистрировать мобильное устройство, чтобы ему могла быть назначена рабочая точка управления, подходящая для мобильных устройств.  

### <a name="distribution-point"></a>Точка распространения

Установите несколько точек распространения и организуйте развертывание содержимого в нескольких точках распространения. Добавьте несколько точек распространения в каждую группу границ, чтобы в ответ на запрос содержимого клиенты получали несколько вариантов. Настройте связи группы границ так, чтобы они реализовывали прогнозируемое поведение при переходе в другую группу границ или облачную точку распространения. Дополнительные сведения см. в разделе о [настройке групп границ](boundary-groups.md).  

### <a name="application-catalog-web-service-point-and-application-catalog-website-point"></a>Точка веб-службы каталога приложений и точка веб-сайта каталога приложений

> [!Important]
> Пользовательский интерфейс Silverlight каталога приложений не поддерживается в текущей ветви версии 1806. Начиная с версии 1906, обновленные клиенты автоматически используют точку управления для развертываний приложений, доступных пользователю. Но вы не можете устанавливать новые роли каталога приложений. Поддержка ролей каталога приложений прекращена в версии 1910.  
>
> Дополнительные сведения см. в следующих статьях:
>
> - [Настройка центра программного обеспечения](../../../../apps/plan-design/plan-for-software-center.md#bkmk_userex)
> - [Удаленные и устаревшие компоненты](../../../plan-design/changes/deprecated/removed-and-deprecated-cmfeatures.md)  

Установите несколько экземпляров каждой роли системы сайта. Для наилучшей производительности разверните по одному экземпляру на одном сервере системы сайта.  

Каждая роль системы сайта каталога приложений предоставляет ту же информацию, что и другие экземпляры той же роли, вне зависимости от местоположения этой роли в иерархии. Когда клиент делает запрос к каталогу приложений, а для клиентов настроено автоматическое обнаружение точки веб-сайта каталога приложений по умолчанию, клиент перенаправляется к доступному экземпляру. Клиенты отдают предпочтение локальным экземплярам каталога приложений, исходя из текущего сетевого расположения клиента.  

Дополнительные сведения об этом параметре клиента и о том, как работает автоматическое определение, см. в разделе [Агент компьютера](../../../clients/deploy/about-client-settings.md#computer-agent).  


## <a name="high-availability-for-clients"></a><a name="bkmk_client"></a> Высокий уровень доступности для клиентов  

### <a name="client-operations-are-autonomous"></a>Клиенты работают автономно

Автономность клиента Configuration Manager включает в себя следующее.  

- Клиенты не требуют непрерывного контакта с какими-либо конкретными серверами системы сайта. Они используют известные конфигурации для выполнения заранее заданных действий по расписанию.  

- Клиенты могут использовать любой доступный экземпляр роли системы сайта, который предоставляет службы клиентам. Они пытаются связаться с известными серверами до нахождения доступного сервера.  

- Клиенты могут выполнять инвентаризацию, развертывание программного обеспечения и другие аналогичные действия по расписанию вне зависимости от наличия прямого контакта с серверами системы сайта.  

- Клиенты, настроенные для использования резервной точки состояния, могут передавать сведения этой точке, когда они не могут связаться с точкой управления.  

### <a name="clients-can-repair-themselves"></a>Клиенты могут самостоятельно восстанавливаться

Клиенты могут автоматически устранять большинство типичных проблем без прямого вмешательства администратора.  

- Периодически клиенты самостоятельно оценивают свое состояние. Они принимают меры к устранению типичных проблем, используя для этого локальный кэш шагов по устранению исходных файлов.  

- Если клиент не представил сайту информацию о состоянии, сайт может генерировать оповещение. Пользователи, получающие эти оповещения, могут немедленно принимать меры для восстановления нормальной работы клиента.  

### <a name="clients-cache-information-to-use-in-the-future"></a>Клиенты кэшируют данные для использования в будущем

Взаимодействуя с точкой управления, клиент может получать и кэшировать следующую информацию:  

- Параметры клиента  

- Расписания для клиента  

- сведения о развертывании программного обеспечения и загрузке ПО, которое запланировано для установки на клиенте, если развертывание настроено для выполнения такого действия.  

Когда клиенты не могут связаться с точкой управления, они локально кэшируют сведения о статусе, состоянии и клиенте, которые они сообщают сайту. Клиент передает эти данные после установления связи с точкой управления.  

### <a name="client-can-submit-status-to-a-fallback-status-point"></a>Клиент может передавать данные о состоянии резервной точке состояния

Настраивая клиент для использования резервной точки состояния, вы предоставляете клиенту еще одну точку, в которую он сможет передавать важные сведения о его работе. Клиенты, настроенные для использования резервной точки состояния, передают сведения о состоянии своей работы соответствующей роли системы сайта, даже когда клиенту не удается связаться с точкой управления.  

### <a name="central-management-of-client-data-and-client-identity"></a>Централизованное управление данными и идентификацией клиента

Важная информация об идентификации каждого клиента хранится в базе данных сайта, а не в самом клиенте, и эта информация связывается с конкретным компьютером или пользователем.  

- исходные файлы клиента на компьютере могут удаляться и переустанавливаться, не затрагивая записи за прошедшие периоды о компьютере, на котором клиент установлен;  

- Сбой клиентского компьютера не влияет на целостность информации, хранящейся в базе данных. Эта информация может оставаться доступной для составления отчетов.  


## <a name="options-for-sites-and-site-system-roles-that-arent-highly-available"></a><a name="bkmk_nonHAoptions"></a> Варианты для сайтов и ролей системы сайта, не поддерживающих высокую доступность

Есть ряд систем сайта, для которых не поддерживается одновременная работа нескольких экземпляров на сайте или в иерархии. Эти сведения помогут вам подготовиться к ситуациям, когда связь с данными системами будет потеряна.  

### <a name="asset-intelligence-synchronization-point-hierarchy"></a>Точка синхронизации каталога аналитики активов (иерархия)

Эта роль системы сайта не рассматривается как критически важная; она обеспечивает дополнительные функциональные возможности в Configuration Manager. Если эта система сайта отключается от сети, следует использовать один из следующих вариантов.  

- Устраните причину перехода системы сайта в автономный режим.  

- Удалите роль с текущего сервера и установите ее на новом сервере.  

### <a name="endpoint-protection-point-hierarchy"></a>Точка Endpoint Protection (иерархия)

Эта роль системы сайта не рассматривается как критически важная; она обеспечивает дополнительные функциональные возможности в Configuration Manager. Если эта система сайта отключается от сети, следует использовать один из следующих вариантов.  

- Устраните причину перехода системы сайта в автономный режим.  

- Удалите роль с текущего сервера и установите ее на новом сервере.  

### <a name="enrollment-point-site"></a>Точка регистрации (сайт)

Эта роль системы сайта не рассматривается как критически важная; она обеспечивает дополнительные функциональные возможности в Configuration Manager. Если эта система сайта отключается от сети, следует использовать один из следующих вариантов.  

- Устраните причину перехода системы сайта в автономный режим.  

- Удалите роль с текущего сервера и установите ее на новом сервере.  

### <a name="enrollment-proxy-point-site"></a>Прокси-точка регистрации (сайт)

Эта роль системы сайта не рассматривается как критически важная; она обеспечивает дополнительные функциональные возможности в Configuration Manager. Тем не менее, можно установить несколько экземпляров этой роли системы сайта, причем на нескольких сайтах в иерархии. Если эта система сайта отключается от сети, следует использовать один из следующих вариантов.  

- Устраните причину перехода системы сайта в автономный режим.  

- Удалите роль с текущего сервера и установите ее на новом сервере.  

Если на сате установлено несколько прокси-точек регистрации, используйте в качестве имени сервера псевдоним DNS. При использовании этой конфигурации циклический перебор DNS обеспечивает некоторый уровень отказоустойчивости и распределения нагрузки при регистрации мобильных устройств пользователями.  

### <a name="fallback-status-point-site-or-hierarchy"></a>Резервная точка состояния (сайт или иерархия)

Эта роль системы сайта не рассматривается как критически важная; она обеспечивает дополнительные функциональные возможности в Configuration Manager. Если эта система сайта отключается от сети, следует использовать один из следующих вариантов.  

- Устраните причину перехода системы сайта в автономный режим.  

- Удалите роль с текущего сервера и установите ее на новом сервере. Так как клиенты назначаются резервной точке состояния во время установки клиента, потребуется изменить существующие клиенты так, чтобы использовать новый сервер системы сайта.  

### <a name="service-connection-point-hierarchy"></a>Точка подключения службы (иерархия)

Хотя эта роль системы сайта является критически важной для своевременного обновления Configuration Manager Current Branch, она используется нечасто. Если эта система отключается от сети, используйте один из следующих вариантов.

- Устраните причину перехода системы сайта в автономный режим.  

- Удалите роль с текущего сервера и установите ее на новом сервере.  


## <a name="see-also"></a>См. также

- [Поддерживаемые конфигурации](../../../plan-design/configs/supported-configurations.md)  

- [Рекомендуемое оборудование](../../../plan-design/configs/recommended-hardware.md)  

- [Поддерживаемые операционные системы для серверов системы сайта](../../../plan-design/configs/supported-operating-systems-for-site-system-servers.md)

- [Предварительные требования к сайтам и системе сайта](../../../plan-design/configs/site-and-site-system-prerequisites.md)  

- [Влияние сбоя сайта](../../manage/site-failure-impacts.md)  
