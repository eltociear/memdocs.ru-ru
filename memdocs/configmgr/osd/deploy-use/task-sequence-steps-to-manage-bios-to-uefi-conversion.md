---
title: Преобразование из BIOS в UEFI
titleSuffix: Configuration Manager
description: Узнайте, как настроить последовательность задач развертывания операционной системы для подготовки раздела FAT32 к переходу на UEFI.
ms.date: 05/14/2020
ms.prod: configuration-manager
ms.technology: configmgr-osd
ms.topic: conceptual
ms.assetid: bd3df04a-902f-4e91-89eb-5584b47d9efa
author: aczechowski
ms.author: aaroncz
manager: dougeby
ms.openlocfilehash: 0118dd448520a6f0c21bfeea5f8509bd8e49fd46
ms.sourcegitcommit: 48005a260bcb2b97d7fe75809c4bf1552318f50a
ms.translationtype: HT
ms.contentlocale: ru-RU
ms.lasthandoff: 05/15/2020
ms.locfileid: "83429397"
---
# <a name="task-sequence-steps-to-manage-bios-to-uefi-conversion"></a>Этапы последовательности задач для управления преобразованием BIOS в UEFI

Windows 10 предоставляет множество новых функций безопасности, для которых используются устройства с поддержкой UEFI. Возможно, у вас есть современные устройства под управлением Windows, которые уже поддерживают UEFI, но используют BIOS прежних версий. Раньше, чтобы реализовать на устройстве поддержку UEFI, приходилось лично подходить к каждому устройству, изменять разбивку жесткого диска и перенастраивать встроенное ПО.

С Configuration Manager можно автоматизировать следующие действия.

- Подготовка жесткого диска для преобразования из BIOS в UEFI
- Преобразование из BIOS в UEFI в рамках процесса обновления на месте
- Получение сведений о UEFI в составе инвентаризации оборудования

## <a name="hardware-inventory-collects-uefi-information"></a>Функция инвентаризации оборудования собирает сведения о UEFI

Доступны класс (**SMS_Firmware**) и свойство (**UEFI**) инвентаризации оборудования, помогающие определить, запускается ли компьютер в режиме UEFI. Когда компьютер запускается в режиме UEFI, свойство **UEFI** принимает значение **TRUE**. Инвентаризация оборудования включает этот класс по умолчанию. Дополнительные сведения об инвентаризации оборудования см. в разделе [Настройка инвентаризации оборудования](../../core/clients/manage/inventory/configure-hardware-inventory.md).

## <a name="create-a-custom-task-sequence-to-prepare-the-hard-drive"></a>Создание пользовательской последовательности задач для подготовки жесткого диска

Последовательность задач развертывания ОС можно настроить с помощью переменной **TSUEFIDrive**. Шаг **Перезагрузить компьютер** подготавливает раздел FAT32 на жестком диске для перехода на UEFI. Далее приводится пример создания шагов последовательности задач для выполнения этого действия.

### <a name="prepare-the-fat32-partition-for-the-conversion-to-uefi"></a>Подготовка раздела FAT32 для преобразования в UEFI

В существующую последовательность задач для установки ОС добавьте новую группу с шагами для преобразования BIOS в UEFI.

1. Создайте новую группу последовательности задач после шагов для сбора файлов и параметров и перед шагами по установке ОС. Например, после группы **Сбор файлов и параметров** создайте группу с именем **BIOS-to-UEFI**.

1. На вкладке **Параметры** новой группы добавьте новую переменную последовательности задач как условие. Задайте **_SMSTSBootUEFI не равно true**. При таком условии последовательность задач выполняет эти действия только на устройствах BIOS.

    :::image type="content" source="media/bios-to-uefi-group.png" alt-text="Условие группы "BIOS в UEFI"":::

1. В новой группе добавьте шаг последовательности задач **Перезагрузить компьютер**. В разделе **Укажите программы, которые необходимо запустить после перезагрузки** выберите **Выбран загрузочный образ, назначенный этой последовательности задач**. Это действие перезагрузит компьютер в среде предустановки Windows.

1. На вкладке **Параметры** добавьте переменную последовательности задач как условие. Задайте **_SMSTSInWinPE равно false**. С этим условием последовательность задач не выполняет этот шаг, если компьютер уже находится в среде предустановки Windows.

    :::image type="content" source="media/restart-in-windows-pe.png" alt-text="Условие для шага перезагрузки компьютера":::

1. Добавьте шаг для запуска средства OEM, которое преобразует встроенное ПО с BIOS в UEFI. Обычно это шаг **Выполнить из командной строки** с командой для запуска средства OEM.

1. Добавьте шаг этапа последовательности задач **Отформатировать диск и создать разделы**. На этом шаге настройте следующие параметры.

    1. Создайте раздел FAT32 для преобразования в UEFI перед установкой операционной системы. Для параметра **Тип диска** выберите **GPT**.

        :::image type="content" source="media/format-and-partition-disk.png" alt-text="Конфигурация шага "Отформатировать диск и создать разделы"":::

    1. Перейдите к свойствам раздела FAT32. В поле **Переменная** введите `TSUEFIDrive`. Обнаружив эту переменную, последовательность задач готовит раздел для перехода на UEFI перед перезагрузкой компьютера.

        :::image type="content" source="media/partition-properties.png" alt-text="Настройка свойств раздела файловой системы FAT32":::

    1. Создайте раздел NTFS, который последовательность задач использует для сохранения своего состояния и хранения файлов журнала.

1. Добавьте еще один шаг последовательности задач **Перезагрузить компьютер**. В разделе **Укажите программы, которые необходимо запустить после перезагрузки** выберите **Выбран загрузочный образ, назначенный этой последовательности задач**, чтобы запускать компьютер в среде Windows PE.

    > [!TIP]
    > По умолчанию размер раздела EFI составляет 500 МБ. В некоторых средах загрузочный образ слишком велик для хранения в этом разделе. Чтобы обойти эту проблему, увеличьте размер раздела EFI. Например, задайте для него 1 ГБ.<!-- SCCMDocs#1024 -->

## <a name="convert-from-bios-to-uefi-during-in-place-upgrade"></a><a name="bkmk_ipu"></a> Переход от BIOS к UEFI при обновлении на месте

Windows 10 содержит простое средство преобразования **MBR2GPT**. Оно автоматизирует процесс повторного разбиения жесткого диска для оборудования с поддержкой UEFI. Средство преобразования можно интегрировать в процесс обновления на месте до Windows 10. Объедините это средство с последовательностью задач обновления и средством OEM, которое преобразует встроенное ПО из BIOS в UEFI.

### <a name="requirements"></a>Requirements (Требования)

- Поддерживаемая версия Windows 10
- компьютеры с поддержкой UEFI;
- OEM-средство для преобразования встроенного ПО компьютера из BIOS в UEFI.

### <a name="process-to-convert-from-bios-to-uefi-during-an-in-place-upgrade-task-sequence"></a>Последовательность задач преобразования из BIOS в UEFI при обновлении на месте

1. [Создание последовательности задач для обновления ОС](create-a-task-sequence-to-upgrade-an-operating-system.md)

1. Откройте последовательность задач для редактирования. В группе **Постобработка** внесите следующие изменения.

    1. Добавьте шаг **Выполнить из командной строки**. Укажите командную строку для инструмента MBR2GPT. При запуске в полной операционной системе настройте его для преобразования диска из MBR в GPT без изменения или удаления данных. В **командной строке** введите следующую команду: `MBR2GPT.exe /convert /disk:0 /AllowFullOS`

    > [!TIP]
    > Вы также можете запустить средство MBR2GPT.EXE из Windows PE, а не в полной версии ОС. Добавьте шаг для перезагрузки компьютера в среде предустановки Windows перед выполнением средства MBR2GPT.EXE. Затем удалите параметр **/AllowFullOS** из командной строки.

    Дополнительные сведения об этом средстве и доступных параметрах см. в описании [MBR2GPT. EXE](https://docs.microsoft.com/windows/deployment/mbr-to-gpt).

    1. Добавьте шаг для запуска средства OEM, которое преобразует встроенное ПО с BIOS в UEFI. Обычно это шаг **Выполнить из командной строки** с командой для запуска средства OEM.

    1. Добавьте шаг **Перезагрузить компьютер** и выберите **Операционная система по умолчанию, установленная в данный момент**.

1. Выполнить развертывание последовательности задач.
